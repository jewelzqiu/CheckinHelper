


网络继电器DLL动态库使用说明





1，简介

网络继电器动态库用VC++编译导出，可以在微软操作系统平台上运行，支持多种语言调用，
我们已经提供了VC++,C#,VB6.0,VB.Net,Delphi7语言的调用方式，以及Demo程序，基本上，用户只要看明白一行代码即可拿来使用。
简单就是强大。并不是因为使用简单，功能也简单。
此网络继电器动态库支持多TCP连接，即是说同时支持任意台网络继电器的连接控制，用户只要简单修改几个字符地址即可直接调用。
DLL的底层接口完全包装和处理完多线程连接的问题。
如此，要实现多管理，底层的网络通信处理，用户可以不用管，只顾处理用户界面即可，根据要控制不同的控制板，传入不同的地址即可。
做到界面与接口完全分离。




2，使用


使用手册，以VB6.0举例
以下是整个Demo程序的源代码。

Private Declare Function DeviceQuaryCommand Lib "RelayControlCtl.dll" (ByVal quary_str As String, ByVal out As String, ByVal out_len As Integer) As Integer



Private Sub Command1_Click()
        Dim y As String * 1024
        b = DeviceQuaryCommand(Text1.Text, y, 1024)
        Text2.Text = y
End Sub



Private Sub Form_Load()
  Text1.Text = "set_relay_val   ETH:TCP:192.168.1.250:2000          R1: ON    R2:OFF    R3:OFF"
End Sub


懂软件的朋友应该不难明白：DeviceQuaryCommand 函数即时我们提供的通用接口。通过此接口，实现各种不同的功能调用。
程序运行结果，大概跟输入的命令类似：比如上一条指令运行返回的y值是：
set_relay_val 192.168.1.250:2000  R1:ON R2:ON 


输入的命令格式要求不严谨，比如可以输入:
"set_relay_val   ETH:TCP:192.168.1.250:2000"
这样的指令，意思是啥都不干，只是返回当前的继电器的值，以供用户判断下一次应该如何设置。也可以这样：
"set_relay_val   R1 :ON  R2 :  ON   ETH :abc.vicp.net: 2000"
等宽松格式，abc.vicp.net用户的域名映射，使用花生壳等提供的域名即可，


以上举例，用户可以灵活使用。
此样例程序和运行结果我们都提供VB6.0,VB.Net,C#,VC++,Delphi7等版本以供用户购买我们的板子时候直接测试和学习使用。

使用些DLL二次开发只供远程控制开，关，查询功能，其它定时控制等情况后续会更新。


